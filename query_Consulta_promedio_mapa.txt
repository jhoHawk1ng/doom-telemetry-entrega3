-- 1) Duraci√≥n promedio por mapa
WITH per_game AS (
  SELECT game_id, map_id, (MAX(tic) - MIN(tic) + 1) AS duration_tics
  FROM telemetry_event
  GROUP BY game_id, map_id
)
SELECT map_id, AVG(duration_tics)::numeric(12,2) AS avg_duration_tics
FROM per_game
GROUP BY map_id
ORDER BY avg_duration_tics DESC
LIMIT 20;